import{j as e,d as M}from"./index-JBMyroTg.js";import{r as a}from"./vendor-C8lAA81b.js";import{s as i,U as g,h as u,A as f,T as U,m as $,e as B,f as y,u as R,C as b,R as P,v as p,w as C,x as q,y as z}from"./antd-7IfSoTVm.js";import{R as A}from"./LockOutlined-BwF944pO.js";import{R as E}from"./InboxOutlined-BfFPWZiW.js";import{R as k}from"./FileImageOutlined-Bi8tJCRf.js";const{Title:I,Text:l,Paragraph:v}=U,{Dragger:G}=g,_=()=>{var m;const[n,T]=a.useState([]),[c,d]=a.useState(!1),r=a.useMemo(()=>JSON.parse(localStorage.getItem("user")||"{}"),[]),L=((m=r.role)==null?void 0:m.toLowerCase())||"",t=["admin","it","hr"].includes(L),x="http://localhost:8000",S=a.useMemo(()=>({name:"files",multiple:!0,action:`${x}/api/upload`,headers:{"X-User-Role":r.role},accept:".jpg,.jpeg,.png",disabled:!t||c,fileList:n,beforeUpload(s){return t?s.size/1024/1024<5?!0:(i.error(`${s.name} quá lớn (vượt quá 5MB)!`),g.LIST_IGNORE):(i.error("Bạn không có thẩm quyền!"),g.LIST_IGNORE)},onChange(s){var j;let o=[...s.fileList];o=o.slice(-5),T(o);const{status:h}=s.file;if(h==="uploading"&&d(!0),h==="done")d(!1),i.success(`${s.file.name} tải lên thành công.`);else if(h==="error"){d(!1);const w=((j=s.file.response)==null?void 0:j.detail)||"Lỗi máy chủ.";i.error(`${s.file.name}: ${w}`)}}}),[t,c,n,r.role,x]);return e.jsxs("div",{style:{padding:"16px",maxWidth:1200,margin:"0 auto"},children:[e.jsxs(u,{justify:"space-between",align:"flex-end",style:{marginBottom:24},children:[e.jsxs("div",{children:[e.jsxs(u,{align:"center",gap:12,children:[e.jsx(f,{icon:e.jsx(M,{}),style:{backgroundColor:"#1890ff",size:"large"}}),e.jsx(I,{level:2,style:{margin:0},children:"Photo Management"})]}),e.jsx(l,{type:"secondary",children:"Hệ thống đồng bộ chân dung nhân viên cho thẻ ID"})]}),e.jsxs($,{color:"blue",children:["Account: ",r.username]})]}),e.jsxs(B,{gutter:[24,24],children:[e.jsxs(y,{xs:24,lg:16,children:[t?e.jsx(R,{title:"Tiêu chuẩn đặt tên tệp",description:e.jsxs(v,{style:{marginBottom:0},children:["Sử dụng ",e.jsx(l,{strong:!0,children:"Mã nhân viên (Employee ID)"})," làm tên file. Ví dụ: ",e.jsx(l,{code:!0,children:"2024001.png"}),". Hệ thống sẽ tự động resize về chuẩn 3x4."]}),type:"info",showIcon:!0,style:{marginBottom:24,borderRadius:12}}):e.jsx(R,{title:"Access Restricted",description:"Tài khoản Staff chỉ có quyền xem dữ liệu. Vui lòng liên hệ IT để cấp quyền upload.",type:"error",showIcon:!0,icon:e.jsx(A,{}),style:{marginBottom:24,borderRadius:12}}),e.jsx(b,{variant:"borderless",style:{borderRadius:16,boxShadow:"0 8px 24px rgba(0,0,0,0.05)"},children:t?e.jsxs(G,{...S,style:{borderRadius:12,padding:32},children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(E,{style:{color:c?"#40a9ff":"#1890ff"}})}),e.jsx(I,{level:4,children:"Kéo thả ảnh nhân viên vào đây"}),e.jsx(v,{type:"secondary",children:"Hệ thống hỗ trợ tải lên hàng loạt (Bulk Upload). Định dạng cho phép: PNG, JPG, JPEG. Kích thước tối đa 5MB/file."})]}):e.jsx(P,{status:"403",title:"403 Unauthorized",subTitle:"Xin lỗi, bạn không có quyền thực hiện thao tác này."})})]}),e.jsx(y,{xs:24,lg:8,children:e.jsx(b,{title:e.jsxs(u,{justify:"space-between",children:[e.jsx("span",{children:"Lịch sử tải lên"}),e.jsx(z,{count:n.length,showZero:!0})]}),variant:"borderless",style:{borderRadius:16,height:"100%",boxShadow:"0 8px 24px rgba(0,0,0,0.05)"},children:e.jsx(p,{dataSource:n,locale:{emptyText:"Chưa có hoạt động nào"},renderItem:s=>e.jsx(p.Item,{children:e.jsx(p.Item.Meta,{avatar:s.status==="done"?e.jsx(C,{style:{color:"#52c41a",fontSize:20}}):s.status==="error"?e.jsx(q,{style:{color:"#ff4d4f",fontSize:20}}):e.jsx(f,{icon:e.jsx(k,{})}),title:e.jsx(l,{ellipsis:!0,style:{width:150},children:s.name}),description:s.status==="done"?"Thành công":s.status==="uploading"?"Đang tải...":"Thất bại"})})})})})]})]})};export{_ as default};
