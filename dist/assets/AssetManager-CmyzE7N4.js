import{j as e,e as de,f as pe,g as fe,c as se,R as ue,a as E}from"./index-JBMyroTg.js";import{r as n,R as he}from"./vendor-C8lAA81b.js";import{I as S,_ as w,e as z,f as m,C as xe,h as C,T as k,g as me,F as f,t as P,p as ge,D as N,d as g,K as T,k as re,B as v,m as L,n as W,S as q,N as je,O as ye,P as be,Q as ve,o as Se,l as we,V as ae,i as Ce,W as Ie,A as ze,r as Me,X as Re,s as R}from"./antd-7IfSoTVm.js";import{R as _e}from"./InboxOutlined-BfFPWZiW.js";import{u as Te}from"./useEmployees-D0hjL4_K.js";var $e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"},De=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:$e}))},Oe=n.forwardRef(De),Le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z"}},{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}}]},name:"check-circle",theme:"outlined"},Pe=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:Le}))},ke=n.forwardRef(Pe),He={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832.6 191.4c-84.6-84.6-221.5-84.6-306 0l-96.9 96.9 51 51 96.9-96.9c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204l-96.9 96.9 51.1 51.1 96.9-96.9c84.4-84.6 84.4-221.5-.1-306.1zM446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l96.9-96.9-51.1-51.1-96.9 96.9c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l96.9-96.9-51-51-96.8 97zM260.3 209.4a8.03 8.03 0 00-11.3 0L209.4 249a8.03 8.03 0 000 11.3l554.4 554.4c3.1 3.1 8.2 3.1 11.3 0l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3L260.3 209.4z"}}]},name:"disconnect",theme:"outlined"},Ae=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:He}))},Be=n.forwardRef(Ae),Fe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M312.1 591.5c3.1 3.1 8.2 3.1 11.3 0l101.8-101.8 86.1 86.2c3.1 3.1 8.2 3.1 11.3 0l226.3-226.5c3.1-3.1 3.1-8.2 0-11.3l-36.8-36.8a8.03 8.03 0 00-11.3 0L517 485.3l-86.1-86.2a8.03 8.03 0 00-11.3 0L275.3 543.4a8.03 8.03 0 000 11.3l36.8 36.8z"}},{tag:"path",attrs:{d:"M904 160H548V96c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H120c-17.7 0-32 14.3-32 32v520c0 17.7 14.3 32 32 32h356.4v32L311.6 884.1a7.92 7.92 0 00-2.3 11l30.3 47.2v.1c2.4 3.7 7.4 4.7 11.1 2.3L512 838.9l161.3 105.8c3.7 2.4 8.7 1.4 11.1-2.3v-.1l30.3-47.2a8 8 0 00-2.3-11L548 776.3V744h356c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 512H160V232h704v440z"}}]},name:"fund-projection-screen",theme:"outlined"},Ee=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:Fe}))},Ve=n.forwardRef(Ee),Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9z"}}]},name:"heart",theme:"filled"},Ye=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:Ue}))},te=n.forwardRef(Ye),Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M536.1 273H488c-4.4 0-8 3.6-8 8v275.3c0 2.6 1.2 5 3.3 6.5l165.3 120.7c3.6 2.6 8.6 1.9 11.2-1.7l28.6-39c2.7-3.7 1.9-8.7-1.7-11.2L544.1 528.5V281c0-4.4-3.6-8-8-8zm219.8 75.2l156.8 38.3c5 1.2 9.9-2.6 9.9-7.7l.8-161.5c0-6.7-7.7-10.5-12.9-6.3L752.9 334.1a8 8 0 003 14.1zm167.7 301.1l-56.7-19.5a8 8 0 00-10.1 4.8c-1.9 5.1-3.9 10.1-6 15.1-17.8 42.1-43.3 80-75.9 112.5a353 353 0 01-112.5 75.9 352.18 352.18 0 01-137.7 27.8c-47.8 0-94.1-9.3-137.7-27.8a353 353 0 01-112.5-75.9c-32.5-32.5-58-70.4-75.9-112.5A353.44 353.44 0 01171 512c0-47.8 9.3-94.2 27.8-137.8 17.8-42.1 43.3-80 75.9-112.5a353 353 0 01112.5-75.9C430.6 167.3 477 158 524.8 158s94.1 9.3 137.7 27.8A353 353 0 01775 261.7c10.2 10.3 19.8 21 28.6 32.3l59.8-46.8C784.7 146.6 662.2 81.9 524.6 82 285 82.1 92.6 276.7 95 516.4 97.4 751.9 288.9 942 524.8 942c185.5 0 343.5-117.6 403.7-282.3 1.5-4.2-.7-8.9-4.9-10.4z"}}]},name:"history",theme:"outlined"},Ne=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:Ge}))},V=n.forwardRef(Ne),We={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"},qe=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:We}))},le=n.forwardRef(qe),Xe={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M922.9 701.9H327.4l29.9-60.9 496.8-.9c16.8 0 31.2-12 34.2-28.6l68.8-385.1c1.8-10.1-.9-20.5-7.5-28.4a34.99 34.99 0 00-26.6-12.5l-632-2.1-5.4-25.4c-3.4-16.2-18-28-34.6-28H96.5a35.3 35.3 0 100 70.6h125.9L246 312.8l58.1 281.3-74.8 122.1a34.96 34.96 0 00-3 36.8c6 11.9 18.1 19.4 31.5 19.4h62.8a102.43 102.43 0 00-20.6 61.7c0 56.6 46 102.6 102.6 102.6s102.6-46 102.6-102.6c0-22.3-7.4-44-20.6-61.7h161.1a102.43 102.43 0 00-20.6 61.7c0 56.6 46 102.6 102.6 102.6s102.6-46 102.6-102.6c0-22.3-7.4-44-20.6-61.7H923c19.4 0 35.3-15.8 35.3-35.3a35.42 35.42 0 00-35.4-35.2zM305.7 253l575.8 1.9-56.4 315.8-452.3.8L305.7 253zm96.9 612.7c-17.4 0-31.6-14.2-31.6-31.6 0-17.4 14.2-31.6 31.6-31.6s31.6 14.2 31.6 31.6a31.6 31.6 0 01-31.6 31.6zm325.1 0c-17.4 0-31.6-14.2-31.6-31.6 0-17.4 14.2-31.6 31.6-31.6s31.6 14.2 31.6 31.6a31.6 31.6 0 01-31.6 31.6z"}}]},name:"shopping-cart",theme:"outlined"},Ke=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:Xe}))},Je=n.forwardRef(Ke),Qe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M168 504.2c1-43.7 10-86.1 26.9-126 17.3-41 42.1-77.7 73.7-109.4S337 212.3 378 195c42.4-17.9 87.4-27 133.9-27s91.5 9.1 133.8 27A341.5 341.5 0 01755 268.8c9.9 9.9 19.2 20.4 27.8 31.4l-60.2 47a8 8 0 003 14.1l175.7 43c5 1.2 9.9-2.6 9.9-7.7l.8-180.9c0-6.7-7.7-10.5-12.9-6.3l-56.4 44.1C765.8 155.1 646.2 92 511.8 92 282.7 92 96.3 275.6 92 503.8a8 8 0 008 8.2h60c4.4 0 7.9-3.5 8-7.8zm756 7.8h-60c-4.4 0-7.9 3.5-8 7.8-1 43.7-10 86.1-26.9 126-17.3 41-42.1 77.8-73.7 109.4A342.45 342.45 0 01512.1 856a342.24 342.24 0 01-243.2-100.8c-9.9-9.9-19.2-20.4-27.8-31.4l60.2-47a8 8 0 00-3-14.1l-175.7-43c-5-1.2-9.9 2.6-9.9 7.7l-.7 181c0 6.7 7.7 10.5 12.9 6.3l56.4-44.1C258.2 868.9 377.8 932 512.2 932c229.2 0 415.5-183.7 419.8-411.8a8 8 0 00-8-8.2z"}}]},name:"sync",theme:"outlined"},Ze=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:Qe}))},et=n.forwardRef(Ze),tt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M876.6 239.5c-.5-.9-1.2-1.8-2-2.5-5-5-13.1-5-18.1 0L684.2 409.3l-67.9-67.9L788.7 169c.8-.8 1.4-1.6 2-2.5 3.6-6.1 1.6-13.9-4.5-17.5-98.2-58-226.8-44.7-311.3 39.7-67 67-89.2 162-66.5 247.4l-293 293c-3 3-2.8 7.9.3 11l169.7 169.7c3.1 3.1 8.1 3.3 11 .3l292.9-292.9c85.5 22.8 180.5.7 247.6-66.4 84.4-84.5 97.7-213.1 39.7-311.3zM786 499.8c-58.1 58.1-145.3 69.3-214.6 33.6l-8.8 8.8-.1-.1-274 274.1-79.2-79.2 230.1-230.1s0 .1.1.1l52.8-52.8c-35.7-69.3-24.5-156.5 33.6-214.6a184.2 184.2 0 01144-53.5L537 318.9a32.05 32.05 0 000 45.3l124.5 124.5a32.05 32.05 0 0045.3 0l132.8-132.8c3.7 51.8-14.4 104.8-53.6 143.9z"}}]},name:"tool",theme:"outlined"},st=function(r,a){return n.createElement(S,w({},r,{ref:a,icon:tt}))},rt=n.forwardRef(st);const{Text:at}=k,lt=({assets:o=[]})=>{const r=n.useMemo(()=>o.reduce((s,d)=>{var t;const p=(t=d.type)==null?void 0:t.toLowerCase();p==="pc"?s.pc++:p==="laptop"?s.laptop++:p==="tablet"?s.tablet++:p==="printer"&&s.printer++,(p==="monitor"||d.monitor&&d.monitor.model)&&s.monitor++;let u=d.usage_status;return u||(d.assigned_to&&d.assigned_to.employee_id?u="In Use":u="Spare"),u==="In Use"?s.inUse++:u==="Spare"?s.spare++:u==="Broken"&&s.broken++,d.health_status==="Critical"&&s.critical++,s},{pc:0,laptop:0,tablet:0,printer:0,monitor:0,inUse:0,spare:0,broken:0,critical:0}),[o]),a=[{title:"PCs",value:r.pc,icon:e.jsx(de,{}),color:"#1890ff",bg:"#e6f7ff"},{title:"Laptops",value:r.laptop,icon:e.jsx(pe,{}),color:"#722ed1",bg:"#f9f0ff"},{title:"Monitors",value:r.monitor,icon:e.jsx(Ve,{}),color:"#eb2f96",bg:"#fff0f6"},{title:"Tablets",value:r.tablet,icon:e.jsx(fe,{}),color:"#13c2c2",bg:"#e6fffb"},{title:"Printers",value:r.printer,icon:e.jsx(se,{}),color:"#fa8c16",bg:"#fff7e6"},{title:"In Use",value:r.inUse,icon:e.jsx(ke,{}),color:"#52c41a",bg:"#f6ffed"},{title:"Spare (Kho)",value:r.spare,icon:e.jsx(_e,{}),color:"#2f54eb",bg:"#f0f5ff"},{title:"Broken",value:r.broken,icon:e.jsx(Be,{}),color:"#faad14",bg:"#fffbe6"},{title:"Critical",value:r.critical,icon:e.jsx(Oe,{}),color:"#f5222d",bg:"#fff1f0",isAlert:!0}];return e.jsx(z,{gutter:[12,12],style:{marginBottom:16},children:a.map((s,d)=>e.jsx(m,{xs:12,sm:8,md:6,lg:4,xl:d<5?4:5,xxl:d<5?2:3,flex:"auto",children:e.jsx(xe,{variant:"borderless",hoverable:!0,style:{borderRadius:"10px",boxShadow:"0 1px 3px rgba(0,0,0,0.05)",height:"100%",overflow:"hidden"},styles:{body:{padding:"12px 16px"}},children:e.jsxs(C,{align:"center",gap:16,children:[e.jsx(C,{align:"center",justify:"center",style:{width:"48px",height:"48px",borderRadius:"12px",backgroundColor:s.bg,flexShrink:0},children:he.cloneElement(s.icon,{style:{fontSize:"22px",color:s.color}})}),e.jsxs(C,{vertical:!0,justify:"center",style:{overflow:"hidden"},children:[e.jsx(at,{type:"secondary",style:{fontSize:"12px",whiteSpace:"nowrap"},children:s.title}),e.jsx(me,{value:s.value,valueStyle:{fontSize:"20px",fontWeight:700,color:s.isAlert&&s.value>0?"#f5222d":"#262626",lineHeight:1.2}})]})]})})},d))})},{Option:M}=T,{TextArea:nt}=g,{Title:ot,Text:it}=k,ct=({open:o,onCancel:r,onFinish:a,editingAsset:s,employees:d,defaultType:p,loading:u})=>{const[t]=f.useForm(),[l,x]=n.useState(p||"PC");n.useEffect(()=>{var h,b,_,c,j,$,H,A;if(o){const D=s?s.type:p||"PC";l!==D&&x(D),s?t.setFieldsValue({...s,cpu:(h=s.specs)==null?void 0:h.cpu,ram:(b=s.specs)==null?void 0:b.ram,storage:(_=s.specs)==null?void 0:_.storage,mainboard:(c=s.specs)==null?void 0:c.mainboard,os:(j=s.software)==null?void 0:j.os,office:($=s.software)==null?void 0:$.office,monitor_model:(H=s.monitor)==null?void 0:H.model,assigned_id:(A=s.assigned_to)==null?void 0:A.employee_id,purchase_date:s.purchase_date?P(s.purchase_date):null}):(t.resetFields(),t.setFieldsValue({type:p||"PC",health_status:"Good",purchase_date:P()}))}},[o,s,p,t]);const I=h=>{a(h)};return e.jsx(ge,{title:e.jsx(ot,{level:4,style:{margin:0},children:s?"Update Asset Information":"Register New Asset"}),open:o,onCancel:r,width:850,footer:null,centered:!0,destroyOnHidden:!0,maskClosable:!1,children:e.jsxs(f,{form:t,layout:"vertical",onFinish:I,onValuesChange:h=>{h.type&&x(h.type)},children:[e.jsxs(z,{gutter:[24,0],children:[e.jsxs(m,{xs:24,md:12,children:[e.jsx(N,{titlePlacement:"left",style:{marginTop:0},children:"General Info"}),e.jsxs(z,{gutter:12,children:[e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"asset_code",label:"Asset Code",rules:[{required:!0,message:"Missing Code"}],children:e.jsx(g,{disabled:!!s,placeholder:"IT-PC-XXX"})})}),e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"type",label:"Asset Type",children:e.jsxs(T,{disabled:!!p,children:[e.jsx(M,{value:"PC",children:"PC"}),e.jsx(M,{value:"Laptop",children:"Laptop"}),e.jsx(M,{value:"Tablet",children:"Tablet"}),e.jsx(M,{value:"Printer",children:"Printer"})]})})})]}),e.jsx(f.Item,{name:"model",label:"Brand & Model",rules:[{required:!0,message:"Missing Model"}],children:e.jsx(g,{placeholder:"Dell Optiplex, HP Probook..."})}),e.jsxs(z,{gutter:12,children:[e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"health_status",label:"Health Status",children:e.jsxs(T,{children:[e.jsx(M,{value:"Good",children:"Good"}),e.jsx(M,{value:"Fair",children:"Fair"}),e.jsx(M,{value:"Critical",children:"Critical"})]})})}),e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"purchase_date",label:"Purchase Date",children:e.jsx(re,{style:{width:"100%"},format:"DD/MM/YYYY"})})})]}),l==="PC"&&e.jsx(f.Item,{name:"monitor_model",label:"Monitor Model",children:e.jsx(g,{placeholder:"Dell E2216H..."})})]}),e.jsxs(m,{xs:24,md:12,children:[e.jsx(N,{titlePlacement:"left",style:{marginTop:0},children:"Technical Specs & User"}),["PC","Laptop","Tablet"].includes(l)?e.jsxs(e.Fragment,{children:[e.jsxs(z,{gutter:12,children:[e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"cpu",label:"CPU / Processor",children:e.jsx(g,{placeholder:"e.g. i5-13400"})})}),e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"ram",label:"RAM Memory",children:e.jsx(g,{placeholder:"e.g. 16GB DDR4"})})})]}),e.jsx(f.Item,{name:"storage",label:"Storage (HDD/SSD)",children:e.jsx(g,{placeholder:"e.g. SSD 512GB NVMe"})}),l!=="Tablet"&&e.jsx(f.Item,{name:"mainboard",label:"Mainboard",children:e.jsx(g,{placeholder:"e.g. Gigabyte B660M"})})]}):e.jsxs(C,{vertical:!0,align:"center",justify:"center",style:{padding:"30px 0",background:"#fafafa",borderRadius:8,marginBottom:24},children:[e.jsx(se,{style:{fontSize:32,color:"#d9d9d9",marginBottom:8}}),e.jsx(it,{type:"secondary",style:{fontSize:12},children:"Specs are not applicable for Printers"})]}),e.jsx(f.Item,{name:"assigned_id",label:"Assigned User",children:e.jsx(T,{placeholder:"Select employee...",allowClear:!0,options:d.map(h=>({value:h.employee_id,label:`${h.employee_name} (${h.employee_department})`})),showSearch:{filterOption:(h,b)=>((b==null?void 0:b.label)??"").toLowerCase().includes(h.toLowerCase())}})})]})]}),e.jsx(N,{titlePlacement:"left",children:"Software Environment & Notes"}),e.jsxs(z,{gutter:12,children:[e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"os",label:"Operating System",children:e.jsx(g,{placeholder:"Windows 10 Pro / Win 11..."})})}),e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"office",label:"Office Version",children:e.jsx(g,{placeholder:"Office 2019 / 2021 / 365..."})})})]}),e.jsx(f.Item,{name:"notes",label:"Remarks / Notes",children:e.jsx(nt,{rows:2,placeholder:"Any repairs, warranty info, or issues..."})}),e.jsxs(C,{justify:"end",gap:"small",style:{marginTop:10,paddingTop:16,borderTop:"1px solid #f0f0f0"},children:[e.jsx(v,{onClick:r,disabled:u,children:"Cancel"}),e.jsx(v,{type:"primary",htmlType:"submit",icon:e.jsx(le,{}),loading:u,children:s?"Update Changes":"Save New Asset"})]})]})})},{Text:U}=k,dt=({assets:o,loading:r,onEdit:a,onDelete:s,canEdit:d,onViewHistory:p})=>{const u=[{title:"Code",dataIndex:"asset_code",width:85,fixed:"left",sorter:(t,l)=>t.asset_code.localeCompare(l.asset_code),render:t=>e.jsx(U,{strong:!0,style:{color:"#1890ff",fontSize:"13px"},children:t})},{title:"User / Dept",dataIndex:"assigned_to",width:170,fixed:"left",filters:[...new Set(o.map(t=>{var l;return(l=t.assigned_to)==null?void 0:l.department}).filter(Boolean))].map(t=>({text:t,value:t})),onFilter:(t,l)=>{var x;return((x=l.assigned_to)==null?void 0:x.department)===t},render:t=>t?e.jsxs(C,{vertical:!0,gap:0,children:[e.jsx(U,{strong:!0,style:{fontSize:"12px",lineHeight:1.2},children:t.employee_name}),e.jsx(U,{type:"secondary",style:{fontSize:"10px"},children:t.department})]}):e.jsx(U,{type:"secondary",style:{fontSize:"11px"},children:"-"})},{title:"Type",dataIndex:"type",width:85,filters:[{text:"PC",value:"PC"},{text:"Laptop",value:"Laptop"},{text:"Tablet",value:"Tablet"},{text:"Printer",value:"Printer"},{text:"Monitor",value:"Monitor"}],onFilter:(t,l)=>l.type===t,render:t=>{var x;const l={PC:{color:"blue"},Laptop:{color:"purple"},Tablet:{color:"cyan"},Printer:{color:"orange"},Monitor:{color:"magenta"}};return e.jsx(L,{color:((x=l[t])==null?void 0:x.color)||"default",style:{margin:0,fontSize:"10px",padding:"0 4px"},children:t})}},{title:"Model",dataIndex:"model",width:110,ellipsis:!0,render:t=>e.jsx(W,{title:t,children:e.jsx("span",{style:{fontSize:"12px",cursor:"help"},children:t})})},{title:"CPU",dataIndex:["specs","cpu"],width:110,ellipsis:!0,render:t=>e.jsx("span",{style:{fontSize:"12px",color:"#595959"},children:t||"-"})},{title:"RAM",dataIndex:["specs","ram"],width:80,render:t=>e.jsx("span",{style:{fontSize:"12px"},children:t})},{title:"Disk",dataIndex:["specs","storage"],width:130,render:t=>e.jsx("span",{style:{fontSize:"11px",fontWeight:500},children:t})},{title:"OS",dataIndex:["software","os"],width:70,render:t=>e.jsx("span",{style:{fontSize:"13px"},children:t||"-"})},{title:"Monitor",dataIndex:["monitor","model"],width:110,ellipsis:!0,filters:[...new Set(o.map(t=>{var l;return(l=t.monitor)==null?void 0:l.model}).filter(Boolean))].map(t=>({text:t,value:t})),onFilter:(t,l)=>{var x;return((x=l.monitor)==null?void 0:x.model)===t},render:t=>e.jsx("span",{style:{fontSize:"12px"},children:t||"-"})},{title:"Status",dataIndex:"usage_status",width:100,align:"center",filters:[{text:"In Use",value:"In Use"},{text:"Spare",value:"Spare"},{text:"Broken",value:"Broken"}],onFilter:(t,l)=>l.usage_status===t,render:t=>{let l="default",x=t||"Spare";return t==="In Use"?l="processing":t==="Spare"?l="success":t==="Broken"&&(l="error"),e.jsx(L,{color:l,style:{margin:0,fontSize:"11px",borderRadius:"10px",minWidth:"60px",textAlign:"center"},children:x})}},{title:"Health",dataIndex:"health_status",width:90,align:"center",render:t=>e.jsxs(L,{color:t==="Good"?"default":t==="Critical"?"error":"warning",style:{margin:0,fontSize:"12px",border:"none",background:"transparent",fontWeight:"bold"},children:[t==="Good"?e.jsx(te,{style:{color:"#52c41a"}}):e.jsx(te,{style:{color:"#f5222d"}})," ",t]})},{title:"Date",dataIndex:"purchase_date",width:90,render:t=>e.jsx("span",{style:{fontSize:"11px"},children:t?P(t).format("DD/MM/YY"):"-"})},{title:"Op",key:"action",fixed:"right",width:100,align:"center",render:(t,l)=>e.jsxs(q,{size:0,children:[e.jsx(W,{title:"View History",children:e.jsx(v,{type:"text",size:"small",icon:e.jsx(je,{style:{fontSize:14,color:"#52c41a"}}),onClick:()=>p(l)})}),d&&e.jsxs(e.Fragment,{children:[e.jsx(W,{title:"Edit",children:e.jsx(v,{type:"text",size:"small",icon:e.jsx(ye,{style:{fontSize:14,color:"#1890ff"}}),onClick:()=>a(l)})}),e.jsx(be,{title:"Delete?",onConfirm:()=>s(l.id),children:e.jsx(v,{type:"text",size:"small",danger:!0,icon:e.jsx(ve,{style:{fontSize:14}})})})]})]})}];return e.jsx(Se,{columns:u,dataSource:o,rowKey:"id",loading:r,size:"small",scroll:{x:1300},style:{background:"#fff",borderRadius:"12px",overflow:"hidden"},pagination:{pageSize:20,placement:["bottomRight"],showSizeChanger:!0}})},{Title:pt,Text:ft}=k,ut=({defaultType:o,filteredCount:r,onSearch:a,onAdd:s,onReload:d,loading:p,canEdit:u})=>e.jsxs(C,{justify:"space-between",align:"center",wrap:"wrap",gap:"middle",style:{marginBottom:16,background:"#fff",padding:"16px",borderRadius:"12px",boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsxs("div",{children:[e.jsx(pt,{level:4,style:{margin:0},children:o?`${o} Inventory`:"Full Asset Management"}),e.jsxs(ft,{type:"secondary",children:["Found ",r," matching items"]})]}),e.jsxs(C,{gap:"small",wrap:"wrap",style:{flex:1,justifyContent:"flex-end"},children:[e.jsx(g,{prefix:e.jsx(we,{style:{color:"#bfbfbf"}}),placeholder:"Search anything...",onChange:t=>a(t.target.value),style:{width:"100%",maxWidth:"350px",borderRadius:"8px"},allowClear:!0}),u&&e.jsx(v,{type:"primary",icon:e.jsx(ae,{}),onClick:s,style:{borderRadius:"8px"},children:"Add New"}),e.jsx(v,{icon:e.jsx(Ce,{}),onClick:d,loading:p,style:{borderRadius:"8px"}})]})]}),{Title:ht,Text:Y}=k,{TextArea:xt}=g,{Option:G}=T,mt=({open:o,onClose:r,asset:a})=>{const[s,d]=n.useState(!1),[p]=f.useForm(),[u,t]=n.useState([{date:(a==null?void 0:a.purchase_date)||"2023-01-01",type:"purchase",title:"Procured / Purchased",desc:"Device added to inventory.",user:"Admin"}]);if(!a)return null;const l=c=>{const j={date:c.date.format("YYYY-MM-DD"),type:c.type,title:x(c.type),desc:c.desc,user:"Me (IT)"};t([j,...u]),R.success("Activity logged successfully"),d(!1),p.resetFields()},x=c=>({repair:"Maintenance / Repair",upgrade:"Hardware Upgrade",software:"Software Update",note:"General Note"})[c]||"Activity Log",I=c=>{switch(c){case"purchase":return e.jsx(Je,{style:{fontSize:16}});case"assign":return e.jsx(ue,{style:{fontSize:16}});case"repair":return e.jsx(rt,{style:{fontSize:16}});case"upgrade":return e.jsx(et,{style:{fontSize:16}});case"software":return e.jsx(V,{style:{fontSize:16}});default:return e.jsx(V,{})}},h=c=>{switch(c){case"purchase":return"blue";case"assign":return"green";case"repair":return"red";case"upgrade":return"purple";case"software":return"cyan";default:return"gray"}},_=[...u].sort((c,j)=>new Date(j.date)-new Date(c.date)).map((c,j)=>({key:j,color:h(c.type),dot:I(c.type),label:e.jsx(Y,{type:"secondary",style:{fontSize:12},children:P(c.date).format("DD/MM/YY")}),children:e.jsxs(e.Fragment,{children:[e.jsx(Y,{strong:!0,children:c.title}),e.jsx("br",{}),e.jsx(Y,{style:{fontSize:13,color:"#595959"},children:c.desc}),e.jsxs("div",{style:{marginTop:4,fontSize:11,color:"#bfbfbf"},children:["By: ",c.user]})]})}));return e.jsxs(Ie,{title:e.jsxs(q,{children:[e.jsx(V,{}),e.jsx("span",{children:"Asset Lifecycle History"})]}),width:600,onClose:r,open:o,styles:{body:{paddingBottom:80}},extra:!s&&e.jsx(v,{type:"primary",size:"small",icon:e.jsx(ae,{}),onClick:()=>d(!0),children:"Add Log"}),children:[e.jsx("div",{style:{background:"#f5f5f5",padding:16,borderRadius:8,marginBottom:24},children:e.jsxs(z,{align:"middle",gutter:16,children:[e.jsx(m,{children:e.jsx(ze,{shape:"square",size:64,style:{backgroundColor:"#1890ff"},icon:e.jsx(V,{})})}),e.jsxs(m,{flex:"auto",children:[e.jsx(ht,{level:4,style:{margin:0},children:a.model}),e.jsxs(q,{children:[e.jsx(L,{color:"blue",children:a.asset_code}),e.jsx(L,{color:a.usage_status==="In Use"?"green":"orange",children:a.usage_status||"Spare"})]})]})]})}),e.jsx(N,{orientation:"left",children:"Activity Timeline"}),s&&e.jsxs("div",{style:{marginBottom:24,padding:16,border:"1px dashed #1890ff",borderRadius:8,background:"#f0f9ff"},children:[e.jsx(Y,{strong:!0,style:{display:"block",marginBottom:12},children:"Log New Activity"}),e.jsxs(f,{form:p,layout:"vertical",onFinish:l,initialValues:{date:P(),type:"note"},children:[e.jsxs(z,{gutter:12,children:[e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"date",label:"Date",rules:[{required:!0}],children:e.jsx(re,{style:{width:"100%"},format:"DD/MM/YYYY"})})}),e.jsx(m,{span:12,children:e.jsx(f.Item,{name:"type",label:"Activity Type",children:e.jsxs(T,{children:[e.jsx(G,{value:"note",children:"General Note"}),e.jsx(G,{value:"repair",children:"Repair / Fix"}),e.jsx(G,{value:"upgrade",children:"Hardware Upgrade"}),e.jsx(G,{value:"software",children:"Software Install"})]})})})]}),e.jsx(f.Item,{name:"desc",label:"Description",rules:[{required:!0,message:"Please enter details"}],children:e.jsx(xt,{rows:2,placeholder:"e.g. Upgraded RAM to 16GB..."})}),e.jsxs(C,{justify:"end",gap:8,children:[e.jsx(v,{size:"small",icon:e.jsx(Me,{}),onClick:()=>d(!1),children:"Cancel"}),e.jsx(v,{type:"primary",size:"small",icon:e.jsx(le,{}),htmlType:"submit",children:"Save Log"})]})]})]}),e.jsx(Re,{mode:"left",items:_})]})},St=({defaultType:o})=>{const{employees:r,fetchEmployees:a}=Te(),[s,d]=n.useState([]),[p,u]=n.useState(!1),[t,l]=n.useState(""),[x,I]=n.useState(!1),[h,b]=n.useState(null),[_,c]=n.useState(!1),[j,$]=n.useState(!1),[H,A]=n.useState(null),D=JSON.parse(localStorage.getItem("user")||"{}"),ne=D.role?D.role.toLowerCase():"",X=["admin","it"].includes(ne);n.useEffect(()=>{B()},[]);const B=async()=>{u(!0);try{const[i]=await Promise.all([E.get("/api/assets"),a()]);d(i.data)}catch(i){console.error("Fetch error:",i),R.error("Cannot load asset data")}finally{u(!1)}},oe=async i=>{try{await E.delete(`/api/assets/${i}`),R.success("Deleted successfully"),B()}catch{R.error("Delete failed")}},ie=async i=>{c(!0);try{const y=r.find(F=>F.employee_id===i.assigned_id),O={...i,purchase_date:i.purchase_date?i.purchase_date.format("YYYY-MM-DD"):null,usage_status:i.usage_status,assigned_to:y?{employee_id:y.employee_id,employee_name:y.employee_name,department:y.employee_department}:null,specs:{cpu:i.cpu,ram:i.ram,storage:i.storage,mainboard:i.mainboard},software:{os:i.os,office:i.office},monitor:i.type==="PC"?{model:i.monitor_model}:null,notes:i.notes};h?(await E.put(`/api/assets/${h.id}`,O),R.success("Updated successfully")):(await E.post("/api/assets",O),R.success("Created successfully")),I(!1),B()}catch(y){console.error("Save error:",y),R.error("Save Error")}finally{c(!1)}},ce=i=>{A(i),$(!0)},K=s.filter(i=>{var O,F,J,Q,Z,ee;if(o&&i.type!==o)return!1;if(!t)return!0;const y=t.toLowerCase();return((O=i.asset_code)==null?void 0:O.toLowerCase().includes(y))||((F=i.model)==null?void 0:F.toLowerCase().includes(y))||((Q=(J=i.assigned_to)==null?void 0:J.employee_name)==null?void 0:Q.toLowerCase().includes(y))||((ee=(Z=i.assigned_to)==null?void 0:Z.department)==null?void 0:ee.toLowerCase().includes(y))});return e.jsxs("div",{style:{padding:"0 4px"},children:[e.jsx(lt,{assets:s}),e.jsx(ut,{defaultType:o,filteredCount:K.length,onSearch:l,onAdd:()=>{b(null),I(!0)},onReload:B,loading:p,canEdit:X}),e.jsx(dt,{assets:K,loading:p,canEdit:X,onEdit:i=>{b(i),I(!0)},onDelete:oe,onViewHistory:ce}),e.jsx(ct,{open:x,onCancel:()=>I(!1),onFinish:ie,editingAsset:h,employees:r,defaultType:o,loading:_}),e.jsx(mt,{open:j,onClose:()=>$(!1),asset:H})]})};export{St as default};
